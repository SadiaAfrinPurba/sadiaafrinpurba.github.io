<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Content Manager</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
      }
      .auth-wrap {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 16px;
      }
      .auth-card {
        width: 100%;
        max-width: 360px;
        border: 1px solid #d1d5db;
        border-radius: 10px;
        padding: 20px;
      }
      .auth-card h1 {
        margin: 0 0 12px;
        font-size: 1.25rem;
      }
      .auth-card label {
        display: block;
        margin: 10px 0 4px;
      }
      .auth-card input {
        width: 100%;
        box-sizing: border-box;
        padding: 8px 10px;
      }
      .auth-card button {
        margin-top: 12px;
        width: 100%;
        padding: 9px 10px;
        cursor: pointer;
      }
      .auth-error {
        color: #dc2626;
        font-size: 0.9rem;
        min-height: 1.2em;
        margin-top: 8px;
      }
      #cms-root {
        display: none;
      }
    </style>
  </head>
  <body>
    <div id="auth-root" class="auth-wrap">
      <form class="auth-card" id="auth-form">
        <h1>Admin Login</h1>
        <label for="username">Username</label>
        <input id="username" type="text" autocomplete="username" required />
        <label for="password">Password</label>
        <input id="password" type="password" autocomplete="current-password" required />
        <button type="submit">Continue</button>
        <div class="auth-error" id="auth-error"></div>
      </form>
    </div>

    <div id="cms-root"></div>

    <script>
      (function () {
        var expectedUser = "purba";
        var expectedPass = "#m@keG8app10$";
        var sessionKey = "cms-auth-ok";
        var authRoot = document.getElementById("auth-root");
        var cmsRoot = document.getElementById("cms-root");
        var form = document.getElementById("auth-form");
        var errorEl = document.getElementById("auth-error");

        function showCms() {
          authRoot.style.display = "none";
          cmsRoot.style.display = "block";
          var cmsScript = document.createElement("script");
          cmsScript.src = "https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js";
          document.body.appendChild(cmsScript);
        }

        // If credentials are not configured, allow access so local setup still works.
        if (!expectedUser || !expectedPass) {
          showCms();
          return;
        }

        if (sessionStorage.getItem(sessionKey) === "1") {
          showCms();
          return;
        }

        form.addEventListener("submit", function (event) {
          event.preventDefault();
          var username = document.getElementById("username").value;
          var password = document.getElementById("password").value;

          if (username === expectedUser && password === expectedPass) {
            sessionStorage.setItem(sessionKey, "1");
            showCms();
          } else {
            errorEl.textContent = "Invalid username or password.";
          }
        });
      })();
    </script>
  </body>
</html>
